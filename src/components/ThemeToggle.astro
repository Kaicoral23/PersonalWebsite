---
---

<button
  type="button"
  class="theme-toggle"
  aria-label="Toggle light and dark mode"
  title="Toggle theme"
>
  <span class="theme-toggle-track">
    <span class="theme-toggle-thumb">
      <svg class="theme-toggle-icon theme-toggle-icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" aria-hidden="true">
        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
      </svg>
      <svg class="theme-toggle-icon theme-toggle-icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" aria-hidden="true">
        <circle cx="12" cy="12" r="4" />
        <path d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41" />
      </svg>
    </span>
  </span>
  <span class="theme-toggle-sr" aria-hidden="true">Dark</span>
</button>

<style>
  .theme-toggle {
    --track-width: 2.75rem;
    --track-height: 1.5rem;
    --thumb-size: 1.125rem;
    --thumb-offset: 5px;
    background: none;
    border: none;
    padding: 0;
    cursor: pointer;
    display: flex;
    align-items: center;
    color: var(--color-text);
    flex-shrink: 0;
  }

  .theme-toggle:focus-visible {
    outline: 2px solid var(--color-accent);
    outline-offset: 4px;
    border-radius: 999px;
  }

  .theme-toggle-track {
    width: var(--track-width);
    height: var(--track-height);
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: 999px;
    position: relative;
    transition: background-color var(--theme-duration) ease, border-color var(--theme-duration) ease;
  }

  .theme-toggle-thumb {
    position: absolute;
    top: 50%;
    left: var(--thumb-offset);
    width: var(--thumb-size);
    height: var(--thumb-size);
    background: var(--color-accent);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--color-button-text);
    transform: translateY(-50%);
    transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1), background-color var(--theme-duration) ease, color var(--theme-duration) ease;
  }

  .theme-toggle-icon {
    width: 0.625rem;
    height: 0.625rem;
    position: absolute;
  }

  .theme-toggle-icon-moon {
    opacity: 1;
    transition: opacity 0.25s ease;
  }

  .theme-toggle-icon-sun {
    opacity: 0;
    transition: opacity 0.25s ease;
  }

  :global([data-theme="light"]) .theme-toggle-thumb {
    transform: translateY(-50%) translateX(calc(var(--track-width) - var(--thumb-size) - var(--thumb-offset) * 2));
  }

  :global([data-theme="light"]) .theme-toggle-icon-moon {
    opacity: 0;
  }

  :global([data-theme="light"]) .theme-toggle-icon-sun {
    opacity: 1;
  }

  .theme-toggle-sr {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }
</style>

<script>
  function updateToggleLabels() {
    const theme = document.documentElement.getAttribute('data-theme');
    const label = theme === 'light' ? 'Switch to dark mode' : 'Switch to light mode';
    document.querySelectorAll('.theme-toggle-sr').forEach((el) => { el.textContent = label; });
    document.querySelectorAll('.theme-toggle').forEach((btn) => { btn.setAttribute('aria-label', label); });
  }

  document.querySelectorAll('.theme-toggle').forEach((btn) => {
    btn.addEventListener('click', () => {
      const html = document.documentElement;
      const current = html.getAttribute('data-theme');
      const next = current === 'light' ? 'dark' : 'light';
      html.setAttribute('data-theme', next);
      try {
        localStorage.setItem('theme', next);
      } catch (_) {}
      updateToggleLabels();
    });
  });

  updateToggleLabels();
</script>
